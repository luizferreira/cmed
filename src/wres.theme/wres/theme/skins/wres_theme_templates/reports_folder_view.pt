<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="cmfuemr">

<head>
    <metal:block fill-slot="style_slot">
        <link rel="stylesheet" type="text/css" href="generic_richtext_edit.css" />
    </metal:block>
</head>

<body>
    <div metal:fill-slot="main"
         tal:define="title string:Relatórios;
                     form_data python:request.form">
        <h1>
            <a tal:content="string:${title}">Title</a>
        </h1>
        <fieldset>
        <br/>
        <div id="initial_buttons_div">
            <span class="button" id="patients" style="cursor: hand; cursor: pointer">ANUAL</span> <!--- <span class="button" id="visits" style="cursor: hand; cursor: pointer">DETALHADO</span>-->
        </div>
        <br/>
            <form tal:attributes="action template/id">
                <input type="hidden" name="form.submitted" value="1" />
                <table class="listing width-100">
                    <thead>
                        <th>Item</th>
                        <th>Índice</th>
                        <th>Ano</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <select name="type" selected="GenericDocument">
                                    <option value="Patient">Pacientes</option>
                                    <option value="GenericDocument">Documentos</option>
                                    <option value="Impresso">Impressos</option>
                                    <option value="VisitTemp">Consultas</option>
                                </select>
                            </td>
                            <td>
                                <select name="index">
                                    <option value="created">criados</option>
                                    <option value="modified">modificados</option>
                                    <option value="end">finalizados (consultas apenas)</option>
                                </select>
                            </td>
                            <td>
                                <select name="year" tal:define="date python:int(context.getTodayDate().year());
                                                                numeros python:xrange(0,11);">
                                    <option  tal:repeat="numero numeros" 
                                             tal:attributes="value python:date-numero" 
                                             tal:content="python:date-numero">Ano</option>
                                </select>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <input id="generate" type="submit" name="form.button.save" value="Gerar Relatório" class="context"/>
                <img id="loadergif" tal:attributes="src string:${portal_url}/ajaxloader.gif;" style="display: none;" />
            </form>
            <br/>
            <div tal:condition="python:form_data.has_key('year')">
                <span tal:define="retorno python:context.getReportsByYear(form_data['year'], form_data['type'], form_data['index'])">
                    <!--<span tal:define="graphic python:context.generate_anual_graphics(retorno)"> gerar gráficos futuramente-->
                        <b><span i18n:translate="" tal:content="python:form_data['type']"></span>s
                        <span i18n:translate="" tal:content="python:form_data['index']"></span>(as)
                        <span i18n:translate="" tal:condition="python:form_data['type'] == ''">Resultados</span>:</b><br/>
                        <table class="listing width-100">
                            <tr>
                                <th>Ano</th>
                                <th>Total</th>
                                <th>Jan</th>
                                <th>Fev</th>
                                <th>Mar</th>
                                <th>Abr</th>
                                <th>Mai</th>
                                <th>Jun</th>
                                <th>Jul</th>
                                <th>Ago</th>
                                <th>Set</th>
                                <th>Out</th>
                                <th>Nov</th>
                                <th>Dez</th>
                            </tr>
                            <tr>
                                <td tal:content="retorno/year">2010</td>
                                <td tal:content="retorno/contador">12</td>
                                <td tal:content="retorno/Jan">0</td>
                                <td tal:content="retorno/Feb">0</td>
                                <td tal:content="retorno/Mar">0</td>
                                <td tal:content="retorno/Apr">0</td>
                                <td tal:content="retorno/May">0</td>
                                <td tal:content="retorno/Jun">0</td>
                                <td tal:content="retorno/Jul">0</td>
                                <td tal:content="retorno/Aug">0</td>
                                <td tal:content="retorno/Sep">0</td>
                                <td tal:content="retorno/Oct">0</td>
                                <td tal:content="retorno/Nov">0</td>
                                <td tal:content="retorno/Dec">0</td>
                            </tr>
                        </table>
                    </span>
                <!--</span>-->
            </div>
        </fieldset>  
    </div>
</body>
</html>
