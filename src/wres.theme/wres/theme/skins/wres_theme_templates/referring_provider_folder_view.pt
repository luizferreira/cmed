<html xmlns="http://www.w3.org/1999/xhtml"
      xml:lang="en"
      lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="cmfuemr">

  <head>
      <title i18n:translate="cmfuemr_description_patient_search">Patient search</title>
  </head>

  <body>
  <div metal:fill-slot="main"
       tal:define="capitalized_type_name string:Referring Provider;
                   title string:Buscar MÃ©dico Indicante;
                   searchableText request/searchableText | string:;
                   meta_type string:ReferringProvider;
                   results python:context.portal_catalog.searchResults({'meta_type': meta_type, 'getParsedLastName': searchableText}, sort_on='id', sort_order='ascending');
                   start python:int(path('request/start | nothing') or 0);
                   batch python:modules['ZTUtils'].Batch(results, size=10, start=start);
                   previous python:batch.previous;
                   next python:batch.next;">
                   
        <h1>
          <a i18n:translate="" tal:content="string:${title}" >Title</a>
        </h1>
        <div tal:define="letters string:ABCDEFGHIJKLMNOPQRSTUVWXYZ">
            <tal:block repeat="letter letters">
                <a tal:attributes="href string:${template/id}?searchableText=$letter*"
                   tal:content="letter" >Letter</a>
            </tal:block>
        </div>

        <br />
        <div class="field">
            <form action="" name="searchForm" tal:attributes="action string:${template/id}">
                <label i18n:translate="label_search_text">Search text</label>
                <br/>
                <input type="text" size="25" name="searchableText" tal:attributes="value searchableText" />
                <input class="searchButton" type="submit" name="searchButton" value="Search" i18n:attributes="value" />
            </form>
        </div>

        <!-- Resultados da consulta -->
        <fieldset>
            <legend i18n:translate="legend_results">Results</legend>

            <!-- There are results -->
            <tal:block condition="batch">
                <table class="listing" id="sortable">
                    <thead>
                        <th i18n:translate="listingheader_id">Id</th>
                        <th i18n:translate="listingheader_name">Name</th>

                        
                    </thead>
                    <tbody>
                        <metal:block tal:repeat="item batch">
                            <tr tal:define="oddrow repeat/item/odd" tal:attributes="class python:test(oddrow, 'odd', 'even')">
                                <metal:block tal:define="objeto item/getObject;
                                                         name string: ${objeto/getFirstName} ${objeto/getLastName};">
                                    <td>
                                        <a tal:attributes="href string:${objeto/absolute_url}/base_view"
                                           tal:content="item/id" >
                                            id
                                        </a>
                                    </td>
                                    <td>
                                        <a tal:attributes="href string:${objeto/absolute_url}/base_view"
                                           tal:content="name" >
                                            id
                                        </a>
                                    </td>
                                </metal:block>
                            </tr>
                        </metal:block>
                    </tbody>
                </table>

                <div class="formHelp" i18n:translate="">
                    Showing of <span tal:content="python:start + 1" i18n:name="conta_incio">11</span> to
                    <span tal:content="python:start + len(batch)" i18n:name="conta_fim"></span> of
                    <span tal:content="python:len(results)" i18n:name="conta_total">55</span>
                    <span i18n:translate="" tal:content="string:${capitalized_type_name}" i18n:name="tipo">type</span>
                </div>

            </tal:block>

            <!-- There are no results -->
            <tal:block tal:condition="not:batch">
                <br /><div i18n:translate="help_no_results">
                    There are no results
                </div><br />
            </tal:block>

            <table width="100%">
                <tr>
                    <td width="50%" align="left">
                        <a tal:condition="previous"
                           tal:attributes="href string:${request/URL0}?start:int=${previous/first}&searchableText=$searchableText"
                           href="previous_url" i18n:translate="cmfuemr_previous">previous</a>
                    </td>

                    <td width="50%" align="right">
                        <a tal:condition="next"
                           tal:attributes="href string:${request/URL0}?start:int=${next/first}&searchableText=$searchableText"
                           href="next_url" i18n:translate="cmfuemr_next">next</a>
                    </td>

                </tr>
            </table>

        </fieldset>
    </div>
</body>
</html>
